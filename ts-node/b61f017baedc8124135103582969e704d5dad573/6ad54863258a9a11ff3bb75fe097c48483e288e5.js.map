{"version":3,"file":"/home/admin/Programmi/resourceManagement/AISMfrontend/tools/tasks/seed/build.js.dev.ts","sources":["/home/admin/Programmi/resourceManagement/AISMfrontend/tools/tasks/seed/build.js.dev.ts"],"names":[],"mappings":";AAAA,IAAY,IAAI,WAAM,MAAM,CAAC,CAAA;AAC7B,IAAY,eAAe,WAAM,mBAAmB,CAAC,CAAA;AACrD,IAAY,KAAK,WAAM,cAAc,CAAC,CAAA;AACtC,IAAY,IAAI,WAAM,WAAW,CAAC,CAAA;AAClC,qBAAwC,MAAM,CAAC,CAAA;AAE/C,uBAAmB,cAAc,CAAC,CAAA;AAClC,sBAA8C,aAAa,CAAC,CAAA;AAE5D,IAAM,OAAO,GAAQ,eAAe,EAAE,CAAC;AAEvC,IAAM,gBAAgB,GAAG,IAAI,CAAC,SAAS,CAAC,gBAAM,CAAC,iBAAiB,CAAC,CAAC;AAElE,IAAI,iBAAiB,GAAG,gBAAM,CAAC,sBAAsB,CAAC;AAMtD,iBAAS;IACP,IAAI,SAAc,CAAC;IACnB,IAAI,OAAO,GAAG,IAAI,CAAC,GAAG,CAAC;QACrB,gBAAM,CAAC,SAAS,GAAG,2BAA2B;KAC/C,CAAC,CAAC;IACH,IAAI,GAAG,GAAG;QACR,WAAI,CAAC,gBAAM,CAAC,OAAO,EAAE,SAAS,CAAC;QAC/B,GAAG,GAAG,WAAI,CAAC,gBAAM,CAAC,OAAO,EAAE,cAAc,CAAC;QAC1C,GAAG,GAAG,WAAI,CAAC,gBAAM,CAAC,OAAO,EAAE,kBAAkB,CAAC;QAC9C,GAAG,GAAG,WAAI,CAAC,gBAAM,CAAC,OAAO,EAAE,QAAM,gBAAM,CAAC,6BAA6B,QAAK,CAAC;KAC5E,CAAC;IAEF,IAAI,YAAY,GAAG,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,CAAC;IACjC,IAAI,MAAW,CAAC;IAChB,IAAI,aAAa,GAAG,IAAI,CAAC;IAGzB,EAAE,CAAC,CAAC,iBAAiB,GAAG,gBAAM,CAAC,sBAAsB,CAAC,CAAC,CAAC;QACtD,aAAa,GAAG,KAAK,CAAC;QACtB,SAAS,GAAG,qBAAa,CAAC,EAAC,eAAe,EAAE,IAAI,EAAC,CAAC,CAAC;QACnD,YAAY,GAAG,YAAY,CAAC,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,CAAC,CAAC;QACnD,IAAI,CAAC,GAAG,CAAC,yCAAyC,CAAC,CAAC;IACtD,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,SAAS,GAAG,qBAAa,EAAE,CAAC;QAC5B,YAAY,GAAG,KAAK,CAAC,OAAO,EAAE,YAAY,CAAC,CAAC;IAC9C,CAAC;IAED,MAAM,GAAG,YAAY;SAClB,IAAI,CAAC,OAAO,CAAC,OAAO,EAAE,CAAC;SACvB,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,IAAI,EAAE,CAAC;SAC/B,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,SAAS,CAAC,CAAC;SACnC,EAAE,CAAC,OAAO,EAAE;QACX,iBAAiB,GAAG,gBAAM,CAAC,sBAAsB,CAAC;IACpD,CAAC,CAAC,CAAC;IAEL,EAAE,CAAC,CAAC,aAAa,CAAC,CAAC,CAAC;QAClB,iBAAiB,GAAG,CAAC,CAAC;IACxB,CAAC;IAAC,IAAI,CAAC,CAAC;QACN,iBAAiB,EAAE,CAAC;IACtB,CAAC;IAED,MAAM,CAAC,MAAM,CAAC,EAAE;SACb,IAAI,CAAC,OAAO,CAAC,UAAU,CAAC,KAAK,EAAE,CAAC;SAQhC,IAAI,CAAC,OAAO,CAAC,QAAQ,CAAC,MAAM,CAAC,MAAM,CAClC,sBAAc,EAAE,EAAE;QAChB,iBAAiB,EAAE,gBAAgB;KACpC,CACD,CAAC,CAAC;SACH,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,gBAAM,CAAC,QAAQ,CAAC,CAAC,CAAC;AACtC,CAAC,CAAC","sourcesContent":["import * as gulp from 'gulp';\r\nimport * as gulpLoadPlugins from 'gulp-load-plugins';\r\nimport * as merge from 'merge-stream';\r\nimport * as util from 'gulp-util';\r\nimport { join/*, sep, relative*/ } from 'path';\r\n\r\nimport Config from '../../config';\r\nimport { makeTsProject, templateLocals } from '../../utils';\r\n\r\nconst plugins = <any>gulpLoadPlugins();\r\n\r\nconst jsonSystemConfig = JSON.stringify(Config.SYSTEM_CONFIG_DEV);\r\n\r\nlet typedBuildCounter = Config.TYPED_COMPILE_INTERVAL; // Always start with the typed build.\r\n\r\n/**\r\n * Executes the build process, transpiling the TypeScript files (except the spec and e2e-spec files) for the development\r\n * environment.\r\n */\r\nexport = () => {\r\n  let tsProject: any;\r\n  let typings = gulp.src([\r\n    Config.TOOLS_DIR + '/manual_typings/**/*.d.ts'\r\n  ]);\r\n  let src = [\r\n    join(Config.APP_SRC, '**/*.ts'),\r\n    '!' + join(Config.APP_SRC, '**/*.spec.ts'),\r\n    '!' + join(Config.APP_SRC, '**/*.e2e-spec.ts'),\r\n    '!' + join(Config.APP_SRC, `**/${Config.BOOTSTRAP_FACTORY_PROD_MODULE}.ts`)\r\n  ];\r\n\r\n  let projectFiles = gulp.src(src);\r\n  let result: any;\r\n  let isFullCompile = true;\r\n\r\n  // Only do a typed build every X builds, otherwise do a typeless build to speed things up\r\n  if (typedBuildCounter < Config.TYPED_COMPILE_INTERVAL) {\r\n    isFullCompile = false;\r\n    tsProject = makeTsProject({isolatedModules: true});\r\n    projectFiles = projectFiles.pipe(plugins.cached());\r\n    util.log('Performing typeless TypeScript compile.');\r\n  } else {\r\n    tsProject = makeTsProject();\r\n    projectFiles = merge(typings, projectFiles);\r\n  }\r\n\r\n  result = projectFiles\r\n    .pipe(plugins.plumber())\r\n    .pipe(plugins.sourcemaps.init())\r\n    .pipe(plugins.typescript(tsProject))\r\n    .on('error', () => {\r\n      typedBuildCounter = Config.TYPED_COMPILE_INTERVAL;\r\n    });\r\n\r\n  if (isFullCompile) {\r\n    typedBuildCounter = 0;\r\n  } else {\r\n    typedBuildCounter++;\r\n  }\r\n\r\n  return result.js\r\n    .pipe(plugins.sourcemaps.write())\r\n// Use for debugging with Webstorm/IntelliJ\r\n// https://github.com/mgechev/angular2-seed/issues/1220\r\n//    .pipe(plugins.sourcemaps.write('.', {\r\n//      includeContent: false,\r\n//      sourceRoot: (file: any) =>\r\n//        relative(file.path, PROJECT_ROOT + '/' + APP_SRC).replace(sep, '/') + '/' + APP_SRC\r\n//    }))\r\n    .pipe(plugins.template(Object.assign(\r\n      templateLocals(), {\r\n        SYSTEM_CONFIG_DEV: jsonSystemConfig\r\n      }\r\n     )))\r\n    .pipe(gulp.dest(Config.APP_DEST));\r\n};\r\n"]}