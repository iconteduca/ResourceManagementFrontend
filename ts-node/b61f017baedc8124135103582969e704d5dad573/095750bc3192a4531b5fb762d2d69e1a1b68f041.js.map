{"version":3,"file":"/home/admin/Programmi/resourceManagement/AISMfrontend/tools/tasks/seed/build.html_css.ts","sources":["/home/admin/Programmi/resourceManagement/AISMfrontend/tools/tasks/seed/build.html_css.ts"],"names":[],"mappings":"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","sourcesContent":["import * as autoprefixer from 'autoprefixer';\r\nimport * as cssnano from 'cssnano';\r\nimport * as gulp from 'gulp';\r\nimport * as gulpLoadPlugins from 'gulp-load-plugins';\r\nimport * as merge from 'merge-stream';\r\nimport * as util from 'gulp-util';\r\nimport { join } from 'path';\r\n\r\nimport Config from '../../config';\r\n\r\nconst plugins = <any>gulpLoadPlugins();\r\nconst cleanCss = require('gulp-clean-css');\r\nconst gulpConcatCssConfig = Config.getPluginConfig('gulp-concat-css');\r\n\r\nconst processors = [\r\n  autoprefixer({\r\n    browsers: Config.BROWSER_LIST\r\n  })\r\n];\r\n\r\nconst reportPostCssError = (e: any) => util.log(util.colors.red(e.message));\r\n\r\nconst isProd = Config.ENV === 'prod';\r\n\r\nif (isProd) {\r\n  processors.push(\r\n    cssnano({\r\n      discardComments: {removeAll: true},\r\n      discardUnused: false, // unsafe, see http://goo.gl/RtrzwF\r\n      zindex: false, // unsafe, see http://goo.gl/vZ4gbQ\r\n      reduceIdents: false // unsafe, see http://goo.gl/tNOPv0\r\n    })\r\n  );\r\n}\r\n\r\n/**\r\n * Copies all HTML files in `src/client` over to the `dist/tmp` directory.\r\n */\r\nfunction prepareTemplates() {\r\n  return gulp.src(join(Config.APP_SRC, '**', '*.html'))\r\n    .pipe(gulp.dest(Config.TMP_DIR));\r\n}\r\n\r\n/**\r\n * Execute the appropriate component-stylesheet processing method based on user stylesheet preference.\r\n */\r\nfunction processComponentStylesheets() {\r\n  return Config.ENABLE_SCSS ? processComponentScss() : processComponentCss();\r\n}\r\n\r\n/**\r\n * Process scss files referenced from Angular component `styleUrls` metadata\r\n */\r\nfunction processComponentScss() {\r\n  return gulp.src(join(Config.APP_SRC, '**', '*.scss'))\r\n    .pipe(isProd ? plugins.cached('process-component-scss') : plugins.util.noop())\r\n    .pipe(isProd ? plugins.progeny() : plugins.util.noop())\r\n    .pipe(plugins.sourcemaps.init())\r\n    .pipe(plugins.sass(Config.getPluginConfig('gulp-sass')).on('error', plugins.sass.logError))\r\n    .pipe(plugins.postcss(processors))\r\n    .on('error', reportPostCssError)\r\n    .pipe(plugins.sourcemaps.write(isProd ? '.' : ''))\r\n    .pipe(gulp.dest(isProd ? Config.TMP_DIR : Config.APP_DEST));\r\n}\r\n\r\n/**\r\n * Processes the CSS files within `src/client` excluding those in `src/client/assets` using `postcss` with the\r\n * configured processors.\r\n */\r\nfunction processComponentCss() {\r\n  return gulp.src([\r\n    join(Config.APP_SRC, '**', '*.css'),\r\n    '!' + join(Config.APP_SRC, 'assets', '**', '*.css')\r\n  ])\r\n    .pipe(isProd ? plugins.cached('process-component-css') : plugins.util.noop())\r\n    .pipe(plugins.postcss(processors))\r\n    .on('error', reportPostCssError)\r\n    .pipe(gulp.dest(isProd ? Config.TMP_DIR : Config.APP_DEST));\r\n}\r\n\r\n/**\r\n * Execute external-stylesheet processing method based on presence of --scss flag.\r\n */\r\nfunction processExternalStylesheets() {\r\n  return Config.ENABLE_SCSS ? processAllExternalStylesheets() : processExternalCss();\r\n}\r\n\r\n/**\r\n * Process scss stylesheets located in `src/client/css` and any css dependencies specified in\r\n * the global project configuration.\r\n */\r\nfunction processAllExternalStylesheets() {\r\n  return merge(getExternalCssStream(), getExternalScssStream())\r\n    .pipe(isProd ? plugins.concatCss(gulpConcatCssConfig.targetFile, gulpConcatCssConfig.options) : plugins.util.noop())\r\n    .pipe(plugins.postcss(processors))\r\n    .on('error', reportPostCssError)\r\n    .pipe(isProd ? cleanCss() : plugins.util.noop())\r\n    .pipe(gulp.dest(Config.CSS_DEST));\r\n}\r\n\r\n/**\r\n * Get a stream of external css files for subsequent processing.\r\n */\r\nfunction getExternalCssStream() {\r\n  return gulp.src(getExternalCss())\r\n    .pipe(isProd ? plugins.cached('process-external-css') : plugins.util.noop());\r\n}\r\n\r\n/**\r\n * Get an array of filenames referring to all external css stylesheets.\r\n */\r\nfunction getExternalCss() {\r\n  return Config.DEPENDENCIES.filter(dep => /\\.css$/.test(dep.src)).map(dep => dep.src);\r\n}\r\n\r\n/**\r\n * Get a stream of external scss files for subsequent processing.\r\n */\r\nfunction getExternalScssStream() {\r\n  return gulp.src(getExternalScss())\r\n    .pipe(isProd ? plugins.cached('process-external-scss') : plugins.util.noop())\r\n    .pipe(isProd ? plugins.progeny() : plugins.util.noop())\r\n    .pipe(plugins.sass(Config.getPluginConfig('gulp-sass')).on('error', plugins.sass.logError));\r\n}\r\n\r\n/**\r\n * Get an array of filenames referring to external scss stylesheets located in the global DEPENDENCIES\r\n * as well as in `src/css`.\r\n */\r\nfunction getExternalScss() {\r\n  return Config.DEPENDENCIES.filter(dep => /\\.scss$/.test(dep.src)).map(dep => dep.src)\r\n    .concat([join(Config.CSS_SRC, '**', '*.scss')]);\r\n}\r\n\r\n/**\r\n * Processes the external CSS files using `postcss` with the configured processors.\r\n */\r\nfunction processExternalCss() {\r\n  return getExternalCssStream()\r\n    .pipe(plugins.postcss(processors))\r\n    .pipe(isProd ? plugins.concatCss(gulpConcatCssConfig.targetFile, gulpConcatCssConfig.options) : plugins.util.noop())\r\n    .on('error', reportPostCssError)\r\n    .pipe(isProd ? cleanCss() : plugins.util.noop())\r\n    .pipe(gulp.dest(Config.CSS_DEST));\r\n}\r\n\r\n/**\r\n * Executes the build process, processing the HTML and CSS files.\r\n */\r\nexport = () => merge(processComponentStylesheets(), prepareTemplates(), processExternalStylesheets());\r\n"]}